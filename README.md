# 地図表示サンプル (`test_map_leaflet.html`)

このリポジトリは、JavaScriptの`Map`オブジェクト……ではなく、Webページ上に地図を表示するライブラリ`Leaflet.js`の基本的な使い方を学ぶためのサンプルです。

初学者が「地名や住所のリストを地図上にプロットする」というよくある課題に取り組む際のヒントとなることを目的としています。

## このプログラムの目的

`test_map_leaflet.html` は、いくつかの地名を指定すると、それらを地図上にマーカーとして表示する簡単なWebページです。

-   **機能1:** 指定した複数の場所（例：長野県、フィリピン）が収まるように、地図の表示範囲とズームレベルを自動的に調整します。
-   **機能2:** 場所の名前を元に、外部API（Nominatim）へ問い合わせて緯度経度を検索します。
-   **機能3:** 取得した緯度経度を元に、地図上にマーカーを配置し、クリックすると地名がポップアップで表示されるようにします。

## 使い方

特別なサーバーは必要ありません。`test_map_leaflet.html` ファイルをダブルクリックするか、お使いのWebブラウザで直接開いてください。

2つの地図が表示され、それぞれに「フィリピン」と「大坂」のマーカーがプロットされているのが確認できます。

## コードのポイント（課題を解くためのヒント）

このコードの挙動を理解することが、おそらくあなたの課題を解決する鍵となります。特に、`JavaScript`部分に注目してみましょう。

### 1. `createMap` 関数

地図の生成に関する処理は、すべて`createMap`という関数にまとめられています。

```javascript
function createMap(containerId, places) {
    // ... 地図の初期化処理 ...
}
```

-   `containerId`: 地図を表示したいHTML要素のID（`map1` や `map2`）を受け取ります。
-   `places`: 地図に表示したい場所の名前を**配列**で受け取ります。ここが最も重要な部分です。

### 2. 場所の指定方法

スクリプトの最後で、この`createMap`関数を呼び出しています。

```javascript
// 1枚目: 東京駅は範囲のみ寄与、フィリピンにマーカー
createMap("map1", ["東京駅", "フィリピン"]);

// 2枚目: 東京駅は範囲のみ寄与、大坂にマーカー（ユーザー指定）
createMap("map2", ["東京駅", "大坂"]);
```

`places`引数に `["東京駅", "フィリピン"]` のような配列を渡していることに注目してください。

-   **`places[0]` (配列の先頭):** ` "東京駅"`
-   **`places[1]` (配列の2番目以降):** `"フィリピン"` や `"大坂"`

### 3. 少し特殊なルール（最大のヒント）

このサンプルの`createMap`関数には、少し特殊なルールが実装されています。

-   **配列の先頭の要素（`places[0]`）は、マーカーとしては表示されません。**
-   その代わり、**地図の表示範囲を決めるためだけ**に使われます。

コードの中の以下の部分がその処理に該当します。

```javascript
// ...
if (index !== 0) { // indexが0でない、つまり配列の2番目以降の要素の場合のみマーカーを立てる
    const marker = L.marker([lat, lon]).addTo(map);
    marker.bindPopup(`<strong>${name}</strong>`);
}
// ...
```

このサンプルでは「東京駅」と「フィリピン」が両方見えるように地図の範囲が計算されますが、マーカーが立つのは「フィリピン」だけです。

もし、あなたが取り組んでいる課題が「指定したすべての場所にマーカーを立てたい」というものであれば、この`if (index !== 0)`という条件分岐をどのように変更すればよいか考えてみてください。

---

このサンプルコードが、あなたの学習の助けになれば幸いです。
